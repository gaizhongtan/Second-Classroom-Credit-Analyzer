# 高校二课月报自动化生成工具 (Activity Report AutoFiller)

## 📖 项目简介
这是一个基于 Python 的办公自动化工具，专为高校团委或学生会设计。它能够自动读取“第二课堂”活动的原始数据（活动明细与学分汇总），进行数据清洗、统计分析，并自动将结果填充到标准的 Excel 月报模板中，极大地减少了人工统计的重复劳动和计算错误。

## ✨ 主要功能
* **智能数据分析**：自动统计各分类（如思想成长、文体活动等）的发放学分总数。
* **补发学分剔除**：自动识别并分离标题中包含“补发”字样的活动学分，计算当月实际有效学分。
* **二课之星评选**：自动筛选各单项积分最高者及总分最高的学生，生成“二课之星”名单。
* **模板自动填充**：将计算好的参与人次、签到率、积分数据及名单直接写入规定的 `.xlsx` 月报模板。
* **交互式录入**：通过命令行交互输入当月的基础动态数据（如总人数、活动发布量等）。

## ⚙️ 环境依赖
本项目需要 Python 3.6 及以上版本，并依赖以下第三方库：

* `pandas` (用于数据处理)
* `openpyxl` (用于 Excel 读写)

**安装命令：**
```bash
pip install pandas openpyxl
```

## 📂 文件目录结构说明
**重要：** 为了确保程序能正确找到文件，请务必按照以下结构组织文件，并严格遵守命名规范（文件名必须包含你输入的学院名称）。

```text
项目文件夹/
│
├── main.py                     # 本程序脚本
├── 月报格式（学院） (2)(1).xlsx  # 【必须】空白月报模板文件（请勿改名）
├── [学院名称]活动明细.xlsx       # 【必须】原始数据表1（例如：信息学院活动明细.xlsx）
└── [学院名称]学分汇总.xlsx       # 【必须】原始数据表2（例如：信息学院学分汇总.xlsx）
```

> **注意**：程序会根据你输入的“学院名称”去寻找对应文件。
> * 如果你输入 `信息学院`，程序会自动寻找 `信息学院活动明细.xlsx`。
> * 请确保文件名中不包含多余的空格或符号。

## 🚀 使用步骤

1.  **准备数据**：将下载好的《活动明细》和《学分汇总》Excel 表格放入脚本所在目录，并按上述规范重命名。
2.  **运行程序**：
    ```bash
    python main.py
    ```
3.  **输入数据**：按照屏幕提示依次输入当月数据：
    * 学院名称（如：`信息学院`）
    * 学院总人数（如：`1200`）
    * 活动发布数量
    * 被驳回活动总数
    * 活动参与人次
    * 活动签到率（直接输入数字，如 `85.5`）
    * 人均参与活动数
4.  **获取结果**：程序运行结束后，会在当前目录下生成一个新的 Excel 文件：`[学院名称]月报-已生成.xlsx`。

## 📝 核心逻辑说明
1.  **学分计算公式**：
    * `实际发放学分` = `发放学分总数` - `补发学分总数`
    * `人均分` = `积分总和` / `学院总人数`（保留两位小数）
2.  **异常处理**：
    * 程序会自动过滤掉无关的 `UserWarning`。
    * 如果找不到文件，程序会报错并提示检查文件名。

## 📄 开源协议
MIT License